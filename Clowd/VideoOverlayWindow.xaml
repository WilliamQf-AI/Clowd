<Window x:Class="Clowd.VideoOverlayWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Clowd"
        mc:Ignorable="d"
        Title="VideoOverlayWindow" Height="450" Width="800"
        WindowStyle="None"
        AllowsTransparency="True"
        Topmost="True"
        SnapsToDevicePixels="True"
        DataContext="{Binding RelativeSource={RelativeSource Self}}"
        ShowInTaskbar="False"
        >
    <Window.Background>
        <SolidColorBrush Color="#FFB0B0B0" Opacity="0.00" />
    </Window.Background>
    <Window.Resources>
        <Style x:Key="ButtonTool" TargetType="{x:Type Button}">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="SnapsToDevicePixels" Value="True" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Grid>
                            <Rectangle Name="_bg" Fill="{TemplateBinding Background}"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" />
                            <ContentPresenter x:Name="MyContentPresenter" Content="{TemplateBinding Content}" HorizontalAlignment="Center" VerticalAlignment="Center" />
                            <Rectangle Name="_hover" Fill="#33ffffff"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Visibility="Hidden" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="_hover" Property="Visibility" Value="Visible"  />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Value="0.5" TargetName="MyContentPresenter" Property="Opacity" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid>
        <Canvas Name="dynamicCanvas" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <UserControl Name="selectionBorder"
                     Width="{Binding CroppingRectangleWpf.Width}"
                     Height="{Binding CroppingRectangleWpf.Height}"
                     Canvas.Left="{Binding CroppingRectangleWpf.Left}"
                     Canvas.Top="{Binding CroppingRectangleWpf.Top }">
                <UserControl.Template>
                    <ControlTemplate TargetType="{x:Type UserControl}">
                        <ControlTemplate.Resources>
                            <Storyboard x:Key="BorderDashAnimation" x:Name="BorderDashAnimation" RepeatBehavior="Forever">
                                <DoubleAnimationUsingKeyFrames BeginTime="00:00:00"
                                 Storyboard.TargetName="rectangle"
                                 Storyboard.TargetProperty="(Shape.StrokeDashOffset)">
                                    <SplineDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
                                    <SplineDoubleKeyFrame KeyTime="00:00:00.4000000" Value="8"/>
                                    <SplineDoubleKeyFrame KeyTime="00:00:00.8000000" Value="16"/>
                                    <SplineDoubleKeyFrame KeyTime="00:00:01.2000000" Value="24"/>
                                    <SplineDoubleKeyFrame KeyTime="00:00:01.6000000" Value="32"/>
                                </DoubleAnimationUsingKeyFrames>
                            </Storyboard>
                        </ControlTemplate.Resources>
                        <Grid>
                            <Rectangle
                                 Stroke="#FFFFFF"
                                 StrokeThickness="2"
                                 SnapsToDevicePixels="True"
                                 Margin="-2"
                            />
                            <Rectangle Name="rectangle"
                                 Stroke="#FFFF0000"
                                 StrokeThickness="2"
                                 SnapsToDevicePixels="True"
                                 Margin="-2"
                                 StrokeDashArray="4 4"
                            />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <EventTrigger RoutedEvent="Loaded">
                                <BeginStoryboard Storyboard="{StaticResource BorderDashAnimation}"/>
                            </EventTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </UserControl.Template>
            </UserControl>
            <Border Name="toolActionBar" Background="{StaticResource HighlightBrush}" BorderBrush="LightGray" BorderThickness="1">
                <StackPanel Name="toolActionBarStackPanel" Orientation="Horizontal">
                    <Button x:Name="buttonStart" Style="{StaticResource ButtonTool}" Width="50" Background="DarkGreen" Click="buttonStart_Click">
                        <StackPanel Orientation="Vertical" Margin="5">
                            <Viewbox Height="26" Width="26">
                                <Path Width="172" Height="172" Fill="White" Data="M133.67728,78.42849l-88.01562,-43.62019c-2.66166,-1.34375 -5.84015,-1.21454 -8.39844,0.33594c-2.55829,1.52464 -4.08294,4.26382 -4.08294,7.20974v87.31791c0,2.92007 1.52464,5.65925 4.08294,7.18389c1.39543,0.85276 2.94591,1.26622 4.52223,1.26622c1.34375,0 2.66166,-0.3101 3.87621,-0.90444l88.04147,-43.67188c2.89423,-1.42128 4.72896,-4.34135 4.72896,-7.54567c0,-3.20433 -1.86058,-6.1244 -4.75481,-7.57151z" />
                            </Viewbox>
                            <TextBlock FontSize="10" FontWeight="DemiBold" Foreground="White" HorizontalAlignment="Center">
                                START
                            </TextBlock>
                        </StackPanel>
                    </Button>
                    <Button x:Name="buttonStop" Style="{StaticResource ButtonTool}" Width="50" Background="DarkRed" Click="buttonStop_Click" Visibility="Collapsed">
                        <StackPanel Orientation="Vertical" Margin="5">
                            <Border CornerRadius="4" Height="18" Width="18" Margin="4" Background="White" />
                            <TextBlock FontSize="10" FontWeight="DemiBold" Foreground="White" HorizontalAlignment="Center">
                                STOP
                            </TextBlock>
                        </StackPanel>
                    </Button>
                    <!--<Button Style="{StaticResource ButtonTool}" Width="50" Background="#373737">
                        <StackPanel Orientation="Vertical" Margin="5">
                            <Viewbox Height="26" Width="26">
                                <Path Width="172" Height="172" Fill="White" Data="M28.59668,21.43001c-2.91628,0.00077 -5.54133,1.76841 -6.63871,4.47035c-1.09737,2.70194 -0.44825,5.79937 1.64164,7.83336l12.77962,12.77962c-13.84505,11.11908 -22.82334,24.75204 -27.26693,32.75391c-2.37933,4.28567 -2.30117,9.44511 0.02799,13.75944c8.2775,15.32233 32.0752,50.30664 76.8597,50.30664c14.8749,0 27.27635,-3.90777 37.56901,-9.63021l14.69726,14.69726c1.79752,1.87223 4.46675,2.62641 6.97825,1.97168c2.5115,-0.65472 4.47282,-2.61605 5.12755,-5.12755c0.65472,-2.5115 -0.09946,-5.18073 -1.97168,-6.97825l-114.66667,-114.66667c-1.34928,-1.38698 -3.20203,-2.16948 -5.13704,-2.1696zM86,28.66667c-8.686,0 -16.44179,1.43132 -23.52962,3.66732l18.35059,18.35059c1.6985,-0.25083 3.40887,-0.5179 5.17903,-0.5179c19.78717,0 35.83333,16.04617 35.83333,35.83333c0,1.77017 -0.26707,3.48053 -0.51791,5.17903l24.57943,24.57943c7.697,-8.54267 13.33056,-17.20773 16.69889,-22.96973c2.537,-4.32867 2.52681,-9.64589 0.12598,-14.05339c-8.37783,-15.42983 -32.15023,-50.06868 -76.71973,-50.06868zM56.14355,66.27767l10.48405,10.48405c-1.35246,2.79422 -2.1276,5.917 -2.1276,9.23828c0,11.87517 9.62483,21.5 21.5,21.5c3.32128,0 6.44406,-0.77515 9.23828,-2.1276l10.49805,10.49805c-7.1205,4.72134 -16.00546,6.98355 -25.47526,5.51497c-15.03567,-2.33633 -27.31015,-14.61082 -29.64649,-29.64649c-1.46793,-9.46563 0.81167,-18.34232 5.52897,-25.46126z" />
                            </Viewbox>
                            <TextBlock FontSize="10" FontWeight="DemiBold" Foreground="White" HorizontalAlignment="Center">
                                HIDE
                            </TextBlock>
                        </StackPanel>
                    </Button>-->
                    <Button Style="{StaticResource ButtonTool}" Width="50" Background="#373737" Click="buttonCancel_Click">
                        <StackPanel Orientation="Vertical" Margin="5">
                            <Path Width="26" Height="26" Fill="White" Data="M 6.65625 4 C 6.36875 4 6.10625 4.1125 5.90625 4.3125 L 4.3125 5.90625 C 3.9125 6.30625 3.9125 7 4.3125 7.5 L 9.8125 13 L 4.3125 18.5 C 3.9125 19 3.9125 19.69375 4.3125 20.09375 L 5.90625 21.6875 C 6.40625 22.0875 7.1 22.0875 7.5 21.6875 L 13 16.1875 L 18.5 21.6875 C 19 22.0875 19.69375 22.0875 20.09375 21.6875 L 21.6875 20.09375 C 22.0875 19.59375 22.0875 18.9 21.6875 18.5 L 16.1875 13 L 21.6875 7.5 C 22.0875 7 22.0875 6.30625 21.6875 5.90625 L 20.09375 4.3125 C 19.59375 3.9125 18.9 3.9125 18.5 4.3125 L 13 9.8125 L 7.5 4.3125 C 7.25 4.1125 6.94375 4 6.65625 4 z" />
                            <TextBlock FontSize="10" FontWeight="DemiBold" Foreground="White" HorizontalAlignment="Center">
                                CANCEL
                            </TextBlock>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>
            <Grid Width="{Binding CroppingRectangleWpf.Width}"
                  Height="{Binding CroppingRectangleWpf.Height}"
                  Canvas.Left="{Binding CroppingRectangleWpf.Left}"
                  Canvas.Top="{Binding CroppingRectangleWpf.Top }">
                <TextBlock x:Name="labelCountdown" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="120" Foreground="Red" Opacity="1">
                </TextBlock>
            </Grid>
        </Canvas>
        
    </Grid>
</Window>
